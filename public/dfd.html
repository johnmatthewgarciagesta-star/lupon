<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1.0" />
  <title>DFD – Lupon Case Management System</title>
  <style>
    @import url('https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap');

    *,
    *::before,
    *::after {
      box-sizing: border-box;
      margin: 0;
      padding: 0
    }

    body {
      font-family: 'Inter', sans-serif;
      background: #0d1117;
      color: #e2e8f0;
      min-height: 100vh;
      padding: 32px 20px 80px
    }

    /* ── Header ── */
    .header {
      text-align: center;
      margin-bottom: 36px
    }

    .header h1 {
      font-size: 2rem;
      font-weight: 700;
      letter-spacing: -0.5px;
      background: linear-gradient(135deg, #60a5fa, #a78bfa, #34d399);
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
      margin-bottom: 6px
    }

    .header p {
      color: #64748b;
      font-size: .85rem
    }

    /* ── Tabs ── */
    .tabs {
      display: flex;
      justify-content: center;
      gap: 8px;
      margin-bottom: 32px
    }

    .tab {
      padding: 8px 22px;
      border-radius: 8px;
      border: 1px solid #1e293b;
      background: #0f172a;
      color: #64748b;
      font-size: .82rem;
      font-weight: 500;
      cursor: pointer;
      transition: all .2s
    }

    .tab:hover {
      border-color: #334155;
      color: #94a3b8
    }

    .tab.active {
      background: #1e293b;
      border-color: #3b82f6;
      color: #60a5fa
    }

    /* ── Panel ── */
    .panel {
      display: none
    }

    .panel.active {
      display: block
    }

    /* ── Legend ── */
    .legend {
      display: flex;
      flex-wrap: wrap;
      gap: 14px;
      justify-content: center;
      margin-bottom: 28px
    }

    .legend-item {
      display: flex;
      align-items: center;
      gap: 7px;
      font-size: .75rem;
      color: #94a3b8
    }

    .lb {
      width: 26px;
      height: 16px;
      border-radius: 4px;
      border: 2px solid
    }

    /* ── SVG wrap ── */
    .svg-wrap {
      overflow-x: auto;
      background: #0f172a;
      border: 1px solid #1e293b;
      border-radius: 12px;
      padding: 16px
    }

    svg {
      display: block;
      margin: 0 auto
    }

    /* ── Table ── */
    .tbl-wrap {
      margin-top: 36px;
      overflow-x: auto
    }

    table {
      width: 100%;
      border-collapse: collapse;
      font-size: .8rem
    }

    thead tr {
      background: #1e293b
    }

    th {
      padding: 10px 14px;
      text-align: left;
      color: #64748b;
      font-weight: 600;
      font-size: .7rem;
      letter-spacing: 1px;
      text-transform: uppercase;
      border-bottom: 1px solid #334155
    }

    td {
      padding: 9px 14px;
      border-bottom: 1px solid #1a2332;
      color: #cbd5e1;
      vertical-align: top
    }

    tr:hover td {
      background: #1e293b44
    }

    .tag {
      display: inline-block;
      padding: 2px 8px;
      border-radius: 999px;
      font-size: .67rem;
      font-weight: 600;
      margin: 1px
    }

    .te {
      background: #1e3a5f;
      color: #60a5fa
    }

    .tp {
      background: #2d1b69;
      color: #a78bfa
    }

    .td {
      background: #14532d;
      color: #4ade80
    }
  </style>
</head>

<body>

  <div class="header">
    <h1>Data Flow Diagram</h1>
    <p>Lupon Tagapamayapa Case Management System &nbsp;·&nbsp; Laravel + Inertia/React</p>
  </div>

  <!-- Tabs -->
  <div class="tabs">
    <div class="tab active" onclick="show('ctx')">Context (Level 0)</div>
    <div class="tab" onclick="show('l1')">Level 1 DFD</div>
    <div class="tab" onclick="show('flows')">Data Flow Table</div>
  </div>

  <!-- ══════════════════════════════════════════════════════════════ -->
  <!--  CONTEXT DIAGRAM (Level 0)                                    -->
  <!-- ══════════════════════════════════════════════════════════════ -->
  <div class="panel active" id="ctx">
    <div class="legend">
      <div class="legend-item">
        <div class="lb" style="background:#1e3a5f;border-color:#3b82f6"></div>External Entity
      </div>
      <div class="legend-item">
        <div class="lb" style="background:#2d1b69;border-color:#8b5cf6;border-radius:50%"></div>System Process
      </div>
      <div class="legend-item">
        <div class="lb" style="background:transparent;border-color:#f97316"></div>Data Flow
      </div>
    </div>
    <div class="svg-wrap">
      <svg width="900" height="480" viewBox="0 0 900 480">
        <defs>
          <marker id="a0" markerWidth="8" markerHeight="8" refX="6" refY="3" orient="auto">
            <path d="M0,0 L0,6 L8,3z" fill="#f97316" />
          </marker>
          <marker id="a0b" markerWidth="8" markerHeight="8" refX="6" refY="3" orient="auto">
            <path d="M0,0 L0,6 L8,3z" fill="#60a5fa" />
          </marker>
          <filter id="gp">
            <feGaussianBlur stdDeviation="4" result="b" />
            <feMerge>
              <feMergeNode in="b" />
              <feMergeNode in="SourceGraphic" />
            </feMerge>
          </filter>
          <filter id="gb">
            <feGaussianBlur stdDeviation="4" result="b" />
            <feMerge>
              <feMergeNode in="b" />
              <feMergeNode in="SourceGraphic" />
            </feMerge>
          </filter>
        </defs>
        <rect width="900" height="480" fill="#0f172a" rx="10" />

        <!-- Central System -->
        <ellipse cx="450" cy="240" rx="145" ry="80" fill="#2d1b69" stroke="#8b5cf6" stroke-width="2"
          filter="url(#gp)" />
        <text x="450" y="228" text-anchor="middle" fill="#c4b5fd" font-size="13" font-weight="700"
          font-family="Inter">Lupon Case</text>
        <text x="450" y="246" text-anchor="middle" fill="#c4b5fd" font-size="13" font-weight="700"
          font-family="Inter">Management System</text>
        <text x="450" y="264" text-anchor="middle" fill="#7c3aed" font-size="10" font-family="Inter">(Laravel +
          Inertia/React)</text>

        <!-- E1: User/Admin -->
        <rect x="30" y="195" width="130" height="50" rx="6" fill="#1e3a5f" stroke="#3b82f6" stroke-width="1.5"
          filter="url(#gb)" />
        <text x="95" y="216" text-anchor="middle" fill="#93c5fd" font-size="10" font-weight="600"
          font-family="Inter">User / Admin</text>
        <text x="95" y="232" text-anchor="middle" fill="#60a5fa" font-size="9" font-family="Inter">(Browser)</text>

        <!-- E2: Ghostscript -->
        <rect x="30" y="60" width="130" height="50" rx="6" fill="#1e3a5f" stroke="#3b82f6" stroke-width="1.5"
          filter="url(#gb)" />
        <text x="95" y="81" text-anchor="middle" fill="#93c5fd" font-size="10" font-weight="600"
          font-family="Inter">Ghostscript</text>
        <text x="95" y="97" text-anchor="middle" fill="#60a5fa" font-size="9" font-family="Inter">PDF → PNG</text>

        <!-- E3: Browsershot -->
        <rect x="30" y="360" width="130" height="50" rx="6" fill="#1e3a5f" stroke="#3b82f6" stroke-width="1.5"
          filter="url(#gb)" />
        <text x="95" y="381" text-anchor="middle" fill="#93c5fd" font-size="10" font-weight="600"
          font-family="Inter">Browsershot</text>
        <text x="95" y="397" text-anchor="middle" fill="#60a5fa" font-size="9" font-family="Inter">HTML → PDF</text>

        <!-- E4: PDF Templates -->
        <rect x="740" y="60" width="140" height="50" rx="6" fill="#1e3a5f" stroke="#3b82f6" stroke-width="1.5"
          filter="url(#gb)" />
        <text x="810" y="81" text-anchor="middle" fill="#93c5fd" font-size="10" font-weight="600"
          font-family="Inter">PDF Templates</text>
        <text x="810" y="97" text-anchor="middle" fill="#60a5fa" font-size="9" font-family="Inter">public/forms/</text>

        <!-- E5: MySQL DB -->
        <rect x="740" y="360" width="140" height="50" rx="6" fill="#1e3a5f" stroke="#3b82f6" stroke-width="1.5"
          filter="url(#gb)" />
        <text x="810" y="381" text-anchor="middle" fill="#93c5fd" font-size="10" font-weight="600"
          font-family="Inter">MySQL Database</text>
        <text x="810" y="397" text-anchor="middle" fill="#60a5fa" font-size="9" font-family="Inter">cases, docs,
          users</text>

        <!-- Flows: User ↔ System -->
        <line x1="160" y1="215" x2="305" y2="225" stroke="#f97316" stroke-width="1.5" marker-end="url(#a0)" />
        <text x="230" y="208" text-anchor="middle" fill="#fb923c" font-size="9" font-family="Inter">HTTP Requests</text>
        <line x1="305" y1="240" x2="160" y2="240" stroke="#60a5fa" stroke-width="1.5" marker-end="url(#a0b)" />
        <text x="230" y="255" text-anchor="middle" fill="#60a5fa" font-size="9" font-family="Inter">Pages / PDF /
          JSON</text>

        <!-- Flows: GS ↔ System -->
        <line x1="160" y1="90" x2="340" y2="185" stroke="#f97316" stroke-width="1.3" stroke-dasharray="5 3"
          marker-end="url(#a0)" />
        <text x="235" y="125" text-anchor="middle" fill="#fb923c" font-size="9" font-family="Inter">PNG image</text>
        <line x1="340" y1="175" x2="160" y2="82" stroke="#f97316" stroke-width="1.3" stroke-dasharray="5 3"
          marker-end="url(#a0)" />
        <text x="200" y="148" text-anchor="middle" fill="#fb923c" font-size="9" font-family="Inter">exec GS cmd</text>

        <!-- Flows: Browsershot ↔ System -->
        <line x1="160" y1="375" x2="340" y2="295" stroke="#f97316" stroke-width="1.3" stroke-dasharray="5 3"
          marker-end="url(#a0)" />
        <text x="230" y="350" text-anchor="middle" fill="#fb923c" font-size="9" font-family="Inter">PDF binary</text>
        <line x1="340" y1="305" x2="160" y2="385" stroke="#f97316" stroke-width="1.3" stroke-dasharray="5 3"
          marker-end="url(#a0)" />
        <text x="200" y="328" text-anchor="middle" fill="#fb923c" font-size="9" font-family="Inter">HTML string</text>

        <!-- Flows: PDF Templates → System -->
        <line x1="740" y1="90" x2="595" y2="185" stroke="#f97316" stroke-width="1.3" stroke-dasharray="5 3"
          marker-end="url(#a0)" />
        <text x="685" y="125" text-anchor="middle" fill="#fb923c" font-size="9" font-family="Inter">PDF file</text>

        <!-- Flows: DB ↔ System -->
        <line x1="740" y1="375" x2="595" y2="295" stroke="#f97316" stroke-width="1.3" stroke-dasharray="5 3"
          marker-end="url(#a0)" />
        <text x="690" y="350" text-anchor="middle" fill="#fb923c" font-size="9" font-family="Inter">query results</text>
        <line x1="595" y1="305" x2="740" y2="385" stroke="#f97316" stroke-width="1.3" stroke-dasharray="5 3"
          marker-end="url(#a0)" />
        <text x="640" y="328" text-anchor="middle" fill="#fb923c" font-size="9" font-family="Inter">SQL queries</text>
      </svg>
    </div>
  </div>

  <!-- ══════════════════════════════════════════════════════════════ -->
  <!--  LEVEL 1 DFD                                                  -->
  <!-- ══════════════════════════════════════════════════════════════ -->
  <div class="panel" id="l1">
    <div class="legend">
      <div class="legend-item">
        <div class="lb" style="background:#1e3a5f;border-color:#3b82f6"></div>External Entity
      </div>
      <div class="legend-item">
        <div class="lb" style="background:#2d1b69;border-color:#8b5cf6;border-radius:50%"></div>Process
      </div>
      <div class="legend-item">
        <div class="lb" style="background:#14532d;border-color:#22c55e;border-radius:0"></div>Data Store
      </div>
      <div class="legend-item">
        <div class="lb" style="background:transparent;border-color:#f97316"></div>Data Flow
      </div>
    </div>
    <div class="svg-wrap">
      <svg width="1060" height="860" viewBox="0 0 1060 860">
        <defs>
          <marker id="ao" markerWidth="8" markerHeight="8" refX="6" refY="3" orient="auto">
            <path d="M0,0 L0,6 L8,3z" fill="#f97316" />
          </marker>
          <marker id="ab" markerWidth="8" markerHeight="8" refX="6" refY="3" orient="auto">
            <path d="M0,0 L0,6 L8,3z" fill="#60a5fa" />
          </marker>
          <marker id="ag" markerWidth="8" markerHeight="8" refX="6" refY="3" orient="auto">
            <path d="M0,0 L0,6 L8,3z" fill="#4ade80" />
          </marker>
          <marker id="ap" markerWidth="8" markerHeight="8" refX="6" refY="3" orient="auto">
            <path d="M0,0 L0,6 L8,3z" fill="#a78bfa" />
          </marker>
          <filter id="gp2">
            <feGaussianBlur stdDeviation="3" result="b" />
            <feMerge>
              <feMergeNode in="b" />
              <feMergeNode in="SourceGraphic" />
            </feMerge>
          </filter>
          <filter id="gb2">
            <feGaussianBlur stdDeviation="3" result="b" />
            <feMerge>
              <feMergeNode in="b" />
              <feMergeNode in="SourceGraphic" />
            </feMerge>
          </filter>
        </defs>
        <rect width="1060" height="860" fill="#0f172a" rx="10" />
        <!-- subtle grid -->
        <g stroke="#1e293b" stroke-width="0.5" opacity="0.4">
          <line x1="0" y1="100" x2="1060" y2="100" />
          <line x1="0" y1="200" x2="1060" y2="200" />
          <line x1="0" y1="300" x2="1060" y2="300" />
          <line x1="0" y1="400" x2="1060" y2="400" />
          <line x1="0" y1="500" x2="1060" y2="500" />
          <line x1="0" y1="600" x2="1060" y2="600" />
          <line x1="0" y1="700" x2="1060" y2="700" />
          <line x1="0" y1="800" x2="1060" y2="800" />
          <line x1="130" y1="0" x2="130" y2="860" />
          <line x1="260" y1="0" x2="260" y2="860" />
          <line x1="390" y1="0" x2="390" y2="860" />
          <line x1="520" y1="0" x2="520" y2="860" />
          <line x1="650" y1="0" x2="650" y2="860" />
          <line x1="780" y1="0" x2="780" y2="860" />
          <line x1="910" y1="0" x2="910" y2="860" />
        </g>

        <!-- ── EXTERNAL ENTITIES ── -->
        <!-- E1 User/Admin -->
        <rect x="14" y="170" width="118" height="52" rx="6" fill="#1e3a5f" stroke="#3b82f6" stroke-width="1.5"
          filter="url(#gb2)" />
        <text x="73" y="191" text-anchor="middle" fill="#93c5fd" font-size="10" font-weight="600"
          font-family="Inter">User / Admin</text>
        <text x="73" y="207" text-anchor="middle" fill="#60a5fa" font-size="9" font-family="Inter">(Browser) E1</text>

        <!-- E2 Ghostscript -->
        <rect x="14" y="500" width="118" height="52" rx="6" fill="#1e3a5f" stroke="#3b82f6" stroke-width="1.5"
          filter="url(#gb2)" />
        <text x="73" y="521" text-anchor="middle" fill="#93c5fd" font-size="10" font-weight="600"
          font-family="Inter">Ghostscript</text>
        <text x="73" y="537" text-anchor="middle" fill="#60a5fa" font-size="9" font-family="Inter">PDF→PNG E2</text>

        <!-- E3 Browsershot -->
        <rect x="14" y="600" width="118" height="52" rx="6" fill="#1e3a5f" stroke="#3b82f6" stroke-width="1.5"
          filter="url(#gb2)" />
        <text x="73" y="621" text-anchor="middle" fill="#93c5fd" font-size="10" font-weight="600"
          font-family="Inter">Browsershot</text>
        <text x="73" y="637" text-anchor="middle" fill="#60a5fa" font-size="9" font-family="Inter">HTML→PDF E3</text>

        <!-- E4 PDF Templates -->
        <rect x="928" y="60" width="118" height="52" rx="6" fill="#1e3a5f" stroke="#3b82f6" stroke-width="1.5"
          filter="url(#gb2)" />
        <text x="987" y="81" text-anchor="middle" fill="#93c5fd" font-size="10" font-weight="600"
          font-family="Inter">PDF Templates</text>
        <text x="987" y="97" text-anchor="middle" fill="#60a5fa" font-size="9" font-family="Inter">public/forms
          E4</text>

        <!-- ── DATA STORES ── -->
        <!-- DS1 cases -->
        <rect x="360" y="760" width="200" height="38" fill="#14532d" stroke="#22c55e" stroke-width="1.5" />
        <line x1="360" y1="760" x2="360" y2="798" stroke="#22c55e" stroke-width="2" />
        <text x="460" y="776" text-anchor="middle" fill="#86efac" font-size="10" font-weight="600"
          font-family="Inter">DS1: cases</text>
        <text x="460" y="791" text-anchor="middle" fill="#4ade80" font-size="8" font-family="Inter">LuponCase ·
          MySQL</text>

        <!-- DS2 documents -->
        <rect x="600" y="760" width="200" height="38" fill="#14532d" stroke="#22c55e" stroke-width="1.5" />
        <line x1="600" y1="760" x2="600" y2="798" stroke="#22c55e" stroke-width="2" />
        <text x="700" y="776" text-anchor="middle" fill="#86efac" font-size="10" font-weight="600"
          font-family="Inter">DS2: documents</text>
        <text x="700" y="791" text-anchor="middle" fill="#4ade80" font-size="8" font-family="Inter">Document ·
          MySQL</text>

        <!-- DS3 users -->
        <rect x="120" y="760" width="200" height="38" fill="#14532d" stroke="#22c55e" stroke-width="1.5" />
        <line x1="120" y1="760" x2="120" y2="798" stroke="#22c55e" stroke-width="2" />
        <text x="220" y="776" text-anchor="middle" fill="#86efac" font-size="10" font-weight="600"
          font-family="Inter">DS3: users</text>
        <text x="220" y="791" text-anchor="middle" fill="#4ade80" font-size="8" font-family="Inter">User · MySQL</text>

        <!-- DS4 form_layouts -->
        <rect x="840" y="760" width="200" height="38" fill="#14532d" stroke="#22c55e" stroke-width="1.5" />
        <line x1="840" y1="760" x2="840" y2="798" stroke="#22c55e" stroke-width="2" />
        <text x="940" y="776" text-anchor="middle" fill="#86efac" font-size="10" font-weight="600"
          font-family="Inter">DS4: form_layouts</text>
        <text x="940" y="791" text-anchor="middle" fill="#4ade80" font-size="8" font-family="Inter">FormLayout ·
          MySQL</text>

        <!-- ── PROCESSES ── -->
        <!-- P1 Auth -->
        <ellipse cx="260" cy="100" rx="88" ry="30" fill="#2d1b69" stroke="#8b5cf6" stroke-width="1.5"
          filter="url(#gp2)" />
        <text x="260" y="96" text-anchor="middle" fill="#c4b5fd" font-size="10" font-weight="600"
          font-family="Inter">P1: Authenticate</text>
        <text x="260" y="110" text-anchor="middle" fill="#a78bfa" font-size="9" font-family="Inter">Fortify</text>

        <!-- P2 Dashboard -->
        <ellipse cx="530" cy="100" rx="100" ry="30" fill="#2d1b69" stroke="#8b5cf6" stroke-width="1.5"
          filter="url(#gp2)" />
        <text x="530" y="96" text-anchor="middle" fill="#c4b5fd" font-size="10" font-weight="600"
          font-family="Inter">P2: Dashboard</text>
        <text x="530" y="110" text-anchor="middle" fill="#a78bfa" font-size="9"
          font-family="Inter">DashboardController</text>

        <!-- P6 Analytics -->
        <ellipse cx="800" cy="100" rx="100" ry="30" fill="#2d1b69" stroke="#8b5cf6" stroke-width="1.5"
          filter="url(#gp2)" />
        <text x="800" y="96" text-anchor="middle" fill="#c4b5fd" font-size="10" font-weight="600"
          font-family="Inter">P6: Analytics</text>
        <text x="800" y="110" text-anchor="middle" fill="#a78bfa" font-size="9" font-family="Inter">Static Inertia
          Page</text>

        <!-- P9 Frontend -->
        <ellipse cx="530" cy="220" rx="110" ry="34" fill="#1e3a5f" stroke="#3b82f6" stroke-width="2"
          filter="url(#gb2)" />
        <text x="530" y="215" text-anchor="middle" fill="#bfdbfe" font-size="11" font-weight="700"
          font-family="Inter">P9: Inertia/React</text>
        <text x="530" y="230" text-anchor="middle" fill="#60a5fa" font-size="9" font-family="Inter">Frontend SPA</text>

        <!-- P3 Case Controller -->
        <ellipse cx="260" cy="360" rx="100" ry="30" fill="#2d1b69" stroke="#8b5cf6" stroke-width="1.5"
          filter="url(#gp2)" />
        <text x="260" y="356" text-anchor="middle" fill="#c4b5fd" font-size="10" font-weight="600"
          font-family="Inter">P3: Case Controller</text>
        <text x="260" y="370" text-anchor="middle" fill="#a78bfa" font-size="9" font-family="Inter">CRUD ·
          CaseController</text>

        <!-- P5 Report Controller -->
        <ellipse cx="800" cy="360" rx="100" ry="30" fill="#2d1b69" stroke="#8b5cf6" stroke-width="1.5"
          filter="url(#gp2)" />
        <text x="800" y="356" text-anchor="middle" fill="#c4b5fd" font-size="10" font-weight="600"
          font-family="Inter">P5: Report Controller</text>
        <text x="800" y="370" text-anchor="middle" fill="#a78bfa" font-size="9"
          font-family="Inter">ReportController</text>

        <!-- P4 Document Controller -->
        <ellipse cx="530" cy="430" rx="110" ry="32" fill="#2d1b69" stroke="#8b5cf6" stroke-width="1.5"
          filter="url(#gp2)" />
        <text x="530" y="426" text-anchor="middle" fill="#c4b5fd" font-size="10" font-weight="600"
          font-family="Inter">P4: Document Controller</text>
        <text x="530" y="440" text-anchor="middle" fill="#a78bfa" font-size="9"
          font-family="Inter">DocumentController</text>

        <!-- P7 Visual Editor -->
        <ellipse cx="260" cy="560" rx="100" ry="30" fill="#2d1b69" stroke="#8b5cf6" stroke-width="1.5"
          filter="url(#gp2)" />
        <text x="260" y="556" text-anchor="middle" fill="#c4b5fd" font-size="10" font-weight="600"
          font-family="Inter">P7: Visual Editor</text>
        <text x="260" y="570" text-anchor="middle" fill="#a78bfa" font-size="9" font-family="Inter">Blade View</text>

        <!-- P8 PDF Generator -->
        <ellipse cx="530" cy="560" rx="100" ry="30" fill="#2d1b69" stroke="#8b5cf6" stroke-width="1.5"
          filter="url(#gp2)" />
        <text x="530" y="556" text-anchor="middle" fill="#c4b5fd" font-size="10" font-weight="600"
          font-family="Inter">P8: PDF Generator</text>
        <text x="530" y="570" text-anchor="middle" fill="#a78bfa" font-size="9"
          font-family="Inter">Browsershot::html()</text>

        <!-- ══ FLOWS ══ -->
        <!-- E1 → P1 credentials -->
        <line x1="132" y1="185" x2="172" y2="115" stroke="#f97316" stroke-width="1.5" marker-end="url(#ao)" />
        <text x="130" y="148" fill="#fb923c" font-size="8" font-family="Inter">credentials</text>

        <!-- P1 → DS3 verify -->
        <line x1="220" y1="125" x2="200" y2="752" stroke="#4ade80" stroke-width="1.2" stroke-dasharray="4 3"
          marker-end="url(#ag)" />
        <text x="185" y="440" fill="#4ade80" font-size="8" font-family="Inter">verify</text>

        <!-- P1 → P9 session -->
        <line x1="348" y1="100" x2="420" y2="200" stroke="#f97316" stroke-width="1.5" marker-end="url(#ao)" />
        <text x="395" y="143" fill="#fb923c" font-size="8" font-family="Inter">session</text>

        <!-- E1 → P9 HTTP -->
        <line x1="132" y1="200" x2="420" y2="220" stroke="#f97316" stroke-width="1.5" marker-end="url(#ao)" />
        <text x="260" y="215" fill="#fb923c" font-size="8" font-family="Inter">HTTP requests</text>

        <!-- P9 → E1 rendered UI -->
        <line x1="420" y1="230" x2="132" y2="210" stroke="#60a5fa" stroke-width="1.5" marker-end="url(#ab)" />
        <text x="260" y="245" fill="#60a5fa" font-size="8" font-family="Inter">rendered pages / PDF</text>

        <!-- P9 → P2 GET /dashboard -->
        <line x1="530" y1="186" x2="530" y2="130" stroke="#f97316" stroke-width="1.5" marker-end="url(#ao)" />
        <text x="540" y="162" fill="#fb923c" font-size="8" font-family="Inter">GET /dashboard</text>

        <!-- P2 → P9 Inertia props -->
        <line x1="518" y1="130" x2="518" y2="186" stroke="#60a5fa" stroke-width="1.5" marker-end="url(#ab)" />
        <text x="470" y="162" fill="#60a5fa" font-size="8" font-family="Inter">Inertia props</text>

        <!-- P2 → DS1 query cases -->
        <line x1="480" y1="122" x2="440" y2="752" stroke="#4ade80" stroke-width="1.2" stroke-dasharray="4 3"
          marker-end="url(#ag)" />
        <text x="430" y="440" fill="#4ade80" font-size="8" font-family="Inter">query cases</text>

        <!-- P2 → DS2 query docs -->
        <line x1="580" y1="122" x2="670" y2="752" stroke="#4ade80" stroke-width="1.2" stroke-dasharray="4 3"
          marker-end="url(#ag)" />
        <text x="650" y="440" fill="#4ade80" font-size="8" font-family="Inter">query docs</text>

        <!-- P9 → P6 GET /analytics -->
        <line x1="640" y1="210" x2="720" y2="120" stroke="#f97316" stroke-width="1.5" marker-end="url(#ao)" />
        <text x="700" y="175" fill="#fb923c" font-size="8" font-family="Inter">GET /analytics</text>

        <!-- P6 → P9 static UI -->
        <line x1="710" y1="125" x2="635" y2="215" stroke="#60a5fa" stroke-width="1.5" marker-end="url(#ab)" />
        <text x="640" y="190" fill="#60a5fa" font-size="8" font-family="Inter">static UI</text>

        <!-- P9 → P3 CRUD /cases -->
        <line x1="430" y1="235" x2="340" y2="342" stroke="#f97316" stroke-width="1.5" marker-end="url(#ao)" />
        <text x="355" y="282" fill="#fb923c" font-size="8" font-family="Inter">CRUD /cases</text>

        <!-- P3 → P9 case data -->
        <line x1="348" y1="348" x2="438" y2="238" stroke="#60a5fa" stroke-width="1.5" marker-end="url(#ab)" />
        <text x="420" y="308" fill="#60a5fa" font-size="8" font-family="Inter">case list</text>

        <!-- P3 → DS1 R/W -->
        <line x1="260" y1="390" x2="420" y2="752" stroke="#4ade80" stroke-width="1.2" stroke-dasharray="4 3"
          marker-end="url(#ag)" />
        <text x="300" y="590" fill="#4ade80" font-size="8" font-family="Inter">R/W cases</text>

        <!-- P9 → P5 GET /reports -->
        <line x1="630" y1="235" x2="720" y2="342" stroke="#f97316" stroke-width="1.5" marker-end="url(#ao)" />
        <text x="700" y="282" fill="#fb923c" font-size="8" font-family="Inter">GET /reports</text>

        <!-- P5 → P9 stats -->
        <line x1="712" y1="348" x2="622" y2="238" stroke="#60a5fa" stroke-width="1.5" marker-end="url(#ab)" />
        <text x="640" y="308" fill="#60a5fa" font-size="8" font-family="Inter">report stats</text>

        <!-- P5 → DS1 query -->
        <line x1="800" y1="390" x2="560" y2="752" stroke="#4ade80" stroke-width="1.2" stroke-dasharray="4 3"
          marker-end="url(#ag)" />
        <text x="720" y="590" fill="#4ade80" font-size="8" font-family="Inter">query cases</text>

        <!-- P9 → P4 doc requests -->
        <line x1="530" y1="254" x2="530" y2="398" stroke="#f97316" stroke-width="1.5" marker-end="url(#ao)" />
        <text x="542" y="328" fill="#fb923c" font-size="8" font-family="Inter">doc requests</text>

        <!-- P4 → P9 doc list / response -->
        <line x1="518" y1="398" x2="518" y2="254" stroke="#60a5fa" stroke-width="1.5" marker-end="url(#ab)" />
        <text x="470" y="328" fill="#60a5fa" font-size="8" font-family="Inter">doc list</text>

        <!-- P4 → DS1 read case -->
        <line x1="470" y1="455" x2="450" y2="752" stroke="#4ade80" stroke-width="1.2" stroke-dasharray="4 3"
          marker-end="url(#ag)" />
        <text x="440" y="620" fill="#4ade80" font-size="8" font-family="Inter">read case</text>

        <!-- P4 → DS2 save doc -->
        <line x1="590" y1="455" x2="680" y2="752" stroke="#4ade80" stroke-width="1.2" stroke-dasharray="4 3"
          marker-end="url(#ag)" />
        <text x="660" y="620" fill="#4ade80" font-size="8" font-family="Inter">save doc</text>

        <!-- P4 → DS4 layout -->
        <line x1="635" y1="445" x2="870" y2="752" stroke="#4ade80" stroke-width="1.2" stroke-dasharray="4 3"
          marker-end="url(#ag)" />
        <text x="790" y="620" fill="#4ade80" font-size="8" font-family="Inter">read layout</text>

        <!-- P4 → E4 read PDF -->
        <line x1="635" y1="420" x2="928" y2="100" stroke="#f97316" stroke-width="1.2" stroke-dasharray="4 3"
          marker-end="url(#ao)" />
        <text x="840" y="260" fill="#fb923c" font-size="8" font-family="Inter">read PDF template</text>

        <!-- P4 → P7 render editor -->
        <line x1="420" y1="445" x2="340" y2="542" stroke="#a78bfa" stroke-width="1.5" marker-end="url(#ap)" />
        <text x="340" y="492" fill="#a78bfa" font-size="8" font-family="Inter">editor view</text>

        <!-- P4 → P8 trigger generate -->
        <line x1="530" y1="462" x2="530" y2="530" stroke="#a78bfa" stroke-width="1.5" marker-end="url(#ap)" />
        <text x="542" y="498" fill="#a78bfa" font-size="8" font-family="Inter">generate PDF</text>

        <!-- P7 ↔ E2 Ghostscript -->
        <line x1="160" y1="548" x2="132" y2="530" stroke="#f97316" stroke-width="1.5" marker-end="url(#ao)" />
        <text x="100" y="543" fill="#fb923c" font-size="8" font-family="Inter">exec GS</text>
        <line x1="132" y1="540" x2="160" y2="558" stroke="#60a5fa" stroke-width="1.5" marker-end="url(#ab)" />
        <text x="80" y="558" fill="#60a5fa" font-size="8" font-family="Inter">PNG data</text>

        <!-- P8 ↔ E3 Browsershot -->
        <line x1="430" y1="570" x2="132" y2="618" stroke="#f97316" stroke-width="1.5" marker-end="url(#ao)" />
        <text x="250" y="610" fill="#fb923c" font-size="8" font-family="Inter">HTML string</text>
        <line x1="132" y1="628" x2="430" y2="580" stroke="#60a5fa" stroke-width="1.5" marker-end="url(#ab)" />
        <text x="250" y="650" fill="#60a5fa" font-size="8" font-family="Inter">PDF binary</text>

        <!-- P8 → P9 PDF response -->
        <line x1="620" y1="548" x2="640" y2="254" stroke="#60a5fa" stroke-width="1.5" marker-end="url(#ab)" />
        <text x="650" y="400" fill="#60a5fa" font-size="8" font-family="Inter">PDF response</text>
      </svg>
    </div>
  </div>

  <!-- ══════════════════════════════════════════════════════════════ -->
  <!--  DATA FLOW TABLE                                              -->
  <!-- ══════════════════════════════════════════════════════════════ -->
  <div class="panel" id="flows">
    <div class="tbl-wrap">
      <table>
        <thead>
          <tr>
            <th>#</th>
            <th>Data Flow</th>
            <th>From</th>
            <th>To</th>
            <th>Contents / Notes</th>
          </tr>
        </thead>
        <tbody>
          <tr>
            <td>1</td>
            <td>Login Credentials</td>
            <td><span class="tag te">E1 User</span></td>
            <td><span class="tag tp">P1 Auth</span></td>
            <td>Email + password via Fortify login form (POST /login)</td>
          </tr>
          <tr>
            <td>2</td>
            <td>User Lookup</td>
            <td><span class="tag tp">P1 Auth</span></td>
            <td><span class="tag td">DS3 users</span></td>
            <td>Fortify queries users table to verify hashed password</td>
          </tr>
          <tr>
            <td>3</td>
            <td>Session Cookie</td>
            <td><span class="tag tp">P1 Auth</span></td>
            <td><span class="tag tp">P9 Frontend</span></td>
            <td>Laravel session returned on successful auth; guards all protected routes</td>
          </tr>
          <tr>
            <td>4</td>
            <td>HTTP Requests</td>
            <td><span class="tag te">E1 User</span></td>
            <td><span class="tag tp">P9 Frontend</span></td>
            <td>All browser navigation, form submissions, AJAX via Inertia router</td>
          </tr>
          <tr>
            <td>5</td>
            <td>Rendered Pages / PDF</td>
            <td><span class="tag tp">P9 Frontend</span></td>
            <td><span class="tag te">E1 User</span></td>
            <td>React pages rendered client-side; PDF streamed as attachment</td>
          </tr>
          <tr>
            <td>6</td>
            <td>GET /dashboard</td>
            <td><span class="tag tp">P9 Frontend</span></td>
            <td><span class="tag tp">P2 Dashboard</span></td>
            <td>Inertia request to DashboardController::index()</td>
          </tr>
          <tr>
            <td>7</td>
            <td>Dashboard Inertia Props</td>
            <td><span class="tag tp">P2 Dashboard</span></td>
            <td><span class="tag tp">P9 Frontend</span></td>
            <td>stats, recentCases, statusDistribution, statusPercentages, typeStats, monthlyStats, documentStats</td>
          </tr>
          <tr>
            <td>8</td>
            <td>Case Queries (Dashboard)</td>
            <td><span class="tag tp">P2 Dashboard</span></td>
            <td><span class="tag td">DS1 cases</span></td>
            <td>COUNT total/pending/resolved, GROUP BY status & nature, monthly aggregation via Carbon</td>
          </tr>
          <tr>
            <td>9</td>
            <td>Document Queries (Dashboard)</td>
            <td><span class="tag tp">P2 Dashboard</span></td>
            <td><span class="tag td">DS2 documents</span></td>
            <td>Total count, GROUP BY type (top 5), recent 5 with eager-loaded case relation</td>
          </tr>
          <tr>
            <td>10</td>
            <td>GET /analytics</td>
            <td><span class="tag tp">P9 Frontend</span></td>
            <td><span class="tag tp">P6 Analytics</span></td>
            <td>Route returns static Inertia page — no DB queries, all data is hardcoded SVG charts</td>
          </tr>
          <tr>
            <td>11</td>
            <td>Static Analytics UI</td>
            <td><span class="tag tp">P6 Analytics</span></td>
            <td><span class="tag tp">P9 Frontend</span></td>
            <td>Case Growth Rate, Avg Resolution Time, Settlement Rate, Active Cases, Donut/Bar charts</td>
          </tr>
          <tr>
            <td>12</td>
            <td>CRUD /cases</td>
            <td><span class="tag tp">P9 Frontend</span></td>
            <td><span class="tag tp">P3 CaseCtrl</span></td>
            <td>GET (paginated list + search/filter), POST (create), PUT /{id} (update), DELETE /{id} (soft-delete)</td>
          </tr>
          <tr>
            <td>13</td>
            <td>Case List (paginated)</td>
            <td><span class="tag tp">P3 CaseCtrl</span></td>
            <td><span class="tag tp">P9 Frontend</span></td>
            <td>Paginated LuponCase results with applied search/status/nature filters</td>
          </tr>
          <tr>
            <td>14</td>
            <td>Case R/W</td>
            <td><span class="tag tp">P3 CaseCtrl</span></td>
            <td><span class="tag td">DS1 cases</span></td>
            <td>LuponCase::create, findOrFail, save, delete (SoftDeletes on cases table)</td>
          </tr>
          <tr>
            <td>15</td>
            <td>GET /system-reports</td>
            <td><span class="tag tp">P9 Frontend</span></td>
            <td><span class="tag tp">P5 ReportCtrl</span></td>
            <td>Inertia request to ReportController::index()</td>
          </tr>
          <tr>
            <td>16</td>
            <td>Report Stats</td>
            <td><span class="tag tp">P5 ReportCtrl</span></td>
            <td><span class="tag tp">P9 Frontend</span></td>
            <td>total_cases, cases_this_month, pending, resolved, cases_by_nature, recent_cases (20 rows)</td>
          </tr>
          <tr>
            <td>17</td>
            <td>Case Queries (Reports)</td>
            <td><span class="tag tp">P5 ReportCtrl</span></td>
            <td><span class="tag td">DS1 cases</span></td>
            <td>COUNT, GROUP BY nature_of_case, latest 20 cases for report table</td>
          </tr>
          <tr>
            <td>18</td>
            <td>Document Requests</td>
            <td><span class="tag tp">P9 Frontend</span></td>
            <td><span class="tag tp">P4 DocCtrl</span></td>
            <td>GET /documents (list), GET /documents/create/{type}, GET /documents/view/{id}, POST /documents/generate
            </td>
          </tr>
          <tr>
            <td>19</td>
            <td>Document List</td>
            <td><span class="tag tp">P4 DocCtrl</span></td>
            <td><span class="tag tp">P9 Frontend</span></td>
            <td>Paginated documents with eager-loaded case; rendered via Inertia documents/index</td>
          </tr>
          <tr>
            <td>20</td>
            <td>Read Case Data</td>
            <td><span class="tag tp">P4 DocCtrl</span></td>
            <td><span class="tag td">DS1 cases</span></td>
            <td>LuponCase::where(id)->firstOrFail() to load document_data JSON for editor</td>
          </tr>
          <tr>
            <td>21</td>
            <td>Save Document Record</td>
            <td><span class="tag tp">P4 DocCtrl</span></td>
            <td><span class="tag td">DS2 documents</span></td>
            <td>Document::create with case_id, type, content (all form data), status='Issued', issued_at</td>
          </tr>
          <tr>
            <td>22</td>
            <td>Read Form Layout</td>
            <td><span class="tag tp">P4 DocCtrl</span></td>
            <td><span class="tag td">DS4 form_layouts</span></td>
            <td>FormLayout::where('document_type') → layout_json; fallback to FormLayouts config class</td>
          </tr>
          <tr>
            <td>23</td>
            <td>Read PDF Template</td>
            <td><span class="tag tp">P4 DocCtrl</span></td>
            <td><span class="tag te">E4 Templates</span></td>
            <td>file_exists + file_get_contents on public/forms/{type}.pdf; fallback to complaint.pdf</td>
          </tr>
          <tr>
            <td>24</td>
            <td>Render Visual Editor</td>
            <td><span class="tag tp">P4 DocCtrl</span></td>
            <td><span class="tag tp">P7 VisualEditor</span></td>
            <td>Blade view documents.visual-editor with type, imageBase64, fields, readonly, case</td>
          </tr>
          <tr>
            <td>25</td>
            <td>Exec Ghostscript</td>
            <td><span class="tag tp">P7 VisualEditor</span></td>
            <td><span class="tag te">E2 Ghostscript</span></td>
            <td>Shell exec: gswin64c -sDEVICE=png16m -r300 converts PDF page 1 → temp PNG file</td>
          </tr>
          <tr>
            <td>26</td>
            <td>PNG Image Data</td>
            <td><span class="tag te">E2 Ghostscript</span></td>
            <td><span class="tag tp">P7 VisualEditor</span></td>
            <td>PNG read → base64_encode → passed as $imageBase64 background for the editor canvas</td>
          </tr>
          <tr>
            <td>27</td>
            <td>Trigger PDF Generation</td>
            <td><span class="tag tp">P4 DocCtrl</span></td>
            <td><span class="tag tp">P8 PDFGen</span></td>
            <td>POST /documents/generate with all form fields + layout_overrides JSON</td>
          </tr>
          <tr>
            <td>28</td>
            <td>HTML String</td>
            <td><span class="tag tp">P8 PDFGen</span></td>
            <td><span class="tag te">E3 Browsershot</span></td>
            <td>Blade view documents.templates.print rendered to HTML string; sent to Puppeteer</td>
          </tr>
          <tr>
            <td>29</td>
            <td>PDF Binary</td>
            <td><span class="tag te">E3 Browsershot</span></td>
            <td><span class="tag tp">P8 PDFGen</span></td>
            <td>A4 PDF binary returned; streamed as inline (preview) or attachment (download)</td>
          </tr>
          <tr>
            <td>30</td>
            <td>PDF Response</td>
            <td><span class="tag tp">P8 PDFGen</span></td>
            <td><span class="tag tp">P9 Frontend</span></td>
            <td>Content-Type: application/pdf; Content-Disposition: attachment/inline</td>
          </tr>
        </tbody>
      </table>
    </div>
  </div>

  <script>
    function show(id) {
      document.querySelectorAll('.panel').forEach(p => p.classList.remove('active'));
      document.querySelectorAll('.tab').forEach(t => t.classList.remove('active'));
      document.getElementById(id).classList.add('active');
      event.target.classList.add('active');
    }
  </script>
</body>

</html>